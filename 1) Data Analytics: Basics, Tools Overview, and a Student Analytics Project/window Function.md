## Window Function ‡¶ï‡ßá‡¶® ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶π‡ßü
**‡¶∏‡¶æ‡¶ß‡¶æ‡¶∞‡¶£‡¶§ SQL-‡¶è ‡¶Ü‡¶Æ‡¶∞‡¶æ GROUP BY ‡¶ï‡¶∞‡¶≤‡ßá, ‡¶ó‡ßç‡¶∞‡ßÅ‡¶™‡¶≠‡¶ø‡¶§‡ßç‡¶§‡¶ø‡¶ï ‡¶ï‡ßç‡¶Ø‡¶æ‡¶≤‡¶ï‡ßÅ‡¶≤‡ßá‡¶∂‡¶® ‡¶π‡ßü, ‡¶ï‡¶ø‡¶®‡ßç‡¶§‡ßÅ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶æ ‡¶∞‡ßã‡¶§‡ßá ‡¶∏‡ßá‡¶á ‡¶ï‡ßç‡¶Ø‡¶æ‡¶≤‡¶ï‡ßÅ‡¶≤‡ßá‡¶∂‡¶® ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã ‡¶Ø‡¶æ‡ßü ‡¶®‡¶æ ‚Äî ‡¶ï‡¶æ‡¶∞‡¶£ GROUP BY ‡¶Ü‡¶â‡¶ü‡¶™‡ßÅ‡¶ü‡ßá ‡¶∞‡ßã ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ ‡¶ï‡¶Æ‡¶ø‡ßü‡ßá ‡¶¶‡ßá‡ßü‡•§
Window Function ‡¶è‡¶∞ ‡¶∏‡ßÅ‡¶¨‡¶ø‡¶ß‡¶æ ‡¶π‡¶≤‡ßã, ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶ó‡ßç‡¶∞‡ßÅ‡¶™ ‡¶®‡¶æ ‡¶≠‡ßá‡¶ô‡ßá ‡¶è‡¶ï‡¶á ‡¶ü‡ßá‡¶¨‡¶ø‡¶≤‡ßá ‡¶ï‡ßç‡¶Ø‡¶æ‡¶≤‡¶ï‡ßÅ‡¶≤‡ßá‡¶∂‡¶®, ‡¶∞‚Äç‡ßç‡¶Ø‡¶æ‡¶ô‡ßç‡¶ï‡¶ø‡¶Ç, ‡¶§‡ßÅ‡¶≤‡¶®‡¶æ ‡¶á‡¶§‡ßç‡¶Ø‡¶æ‡¶¶‡¶ø ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶ø‡•§**


## **1Ô∏è‚É£ Ranking Functions** (‡¶∞‚Äå‡ßç‡¶Ø‡¶æ‡¶ô‡ßç‡¶ï ‡¶¨‡¶æ ‡¶™‡¶ú‡¶ø‡¶∂‡¶® ‡¶®‡¶ø‡¶∞‡ßç‡¶ß‡¶æ‡¶∞‡¶£ ‡¶ï‡¶∞‡ßá)

| Function       | ‡¶ï‡¶æ‡¶ú                                                         |
| -------------- | ----------------------------------------------------------- |
| `ROW_NUMBER()` | ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶ø ‡¶∞‡ßã-‡¶ï‡ßá ‡¶ï‡ßç‡¶∞‡¶Æ‡¶æ‡¶®‡ßÅ‡¶∏‡¶æ‡¶∞‡ßá ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ ‡¶¶‡ßá‡ßü (‡¶ü‡¶æ‡ßü ‡¶•‡¶æ‡¶ï‡¶≤‡ßá‡¶ì ‡¶ó‡ßç‡¶Ø‡¶æ‡¶™ ‡¶®‡ßá‡¶á)‡•§ |
| `RANK()`       | ‡¶ü‡¶æ‡ßü ‡¶π‡¶≤‡ßá ‡¶è‡¶ï‡¶á ‡¶∞‚Äç‡ßç‡¶Ø‡¶æ‡¶ô‡ßç‡¶ï, ‡¶ï‡¶ø‡¶®‡ßç‡¶§‡ßÅ ‡¶ó‡ßç‡¶Ø‡¶æ‡¶™ ‡¶•‡¶æ‡¶ï‡ßá‡•§                    |
| `DENSE_RANK()` | ‡¶ü‡¶æ‡ßü ‡¶π‡¶≤‡ßá ‡¶è‡¶ï‡¶á ‡¶∞‚Äç‡ßç‡¶Ø‡¶æ‡¶ô‡ßç‡¶ï, ‡¶ï‡¶ø‡¶®‡ßç‡¶§‡ßÅ ‡¶ó‡ßç‡¶Ø‡¶æ‡¶™ ‡¶•‡¶æ‡¶ï‡ßá ‡¶®‡¶æ‡•§                 |
| `NTILE(n)`     | ‡¶°‡ßá‡¶ü‡¶æ‡¶ï‡ßá **n ‡¶∏‡¶Æ‡¶æ‡¶® ‡¶≠‡¶æ‡¶ó‡ßá** ‡¶≠‡¶æ‡¶ó ‡¶ï‡¶∞‡ßá ‡¶¨‡¶æ‡¶≤‡¶§‡¶ø ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ ‡¶¶‡ßá‡ßü‡•§             |


### Example


### dataset

```sql
CREATE TABLE Students (
    Student VARCHAR(10),
    Score INT
);

INSERT INTO Students (Student, Score) VALUES
('A', 95),
('B', 85),
('C', 85),
('D', 75),
('E', 70),
('F', 70),
('G', 60);
```

‡¶è‡¶¨‡¶æ‡¶∞ Ranking Functions ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶ï:

```sql
SELECT
    Student,
    Score,
    ROW_NUMBER() OVER (ORDER BY Score DESC) AS Row_Number,
    RANK()       OVER (ORDER BY Score DESC) AS Rank_No,
    DENSE_RANK() OVER (ORDER BY Score DESC) AS Dense_Rank,
    NTILE(3)     OVER (ORDER BY Score DESC) AS Ntile_3
FROM Students;
```

üëâ Output ‡¶π‡¶¨‡ßá ‡¶è‡¶Æ‡¶®:

| Student | Score | Row\_Number | Rank\_No | Dense\_Rank | Ntile\_3 |
| ------- | ----- | ----------- | -------- | ----------- | -------- |
| A       | 95    | 1           | 1        | 1           | 1        |
| B       | 85    | 2           | 2        | 2           | 1        |
| C       | 85    | 3           | 2        | 2           | 1        |
| D       | 75    | 4           | 4        | 3           | 2        |
| E       | 70    | 5           | 5        | 4           | 2        |
| F       | 70    | 6           | 5        | 4           | 3        |
| G       | 60    | 7           | 7        | 5           | 3        |


---

## **2Ô∏è‚É£ Aggregate Functions as Window Functions** (‡¶ó‡ßç‡¶∞‡ßÅ‡¶™‡ßá‡¶∞ ‡¶ì‡¶™‡¶∞ ‡¶ï‡ßç‡¶Ø‡¶æ‡¶≤‡¶ï‡ßÅ‡¶≤‡ßá‡¶∂‡¶®, ‡¶ï‡¶ø‡¶®‡ßç‡¶§‡ßÅ ‡¶ó‡ßç‡¶∞‡ßÅ‡¶™ ‡¶®‡¶æ ‡¶≠‡ßá‡¶ô‡ßá)

> ‡¶è‡¶ó‡ßÅ‡¶≤‡ßã ‡¶∏‡¶æ‡¶ß‡¶æ‡¶∞‡¶£ `SUM()` ‡¶¨‡¶æ `AVG()`-‡¶è‡¶∞ ‡¶Æ‡¶§‡ßã‡¶á, ‡¶ï‡¶ø‡¶®‡ßç‡¶§‡ßÅ `OVER()` ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶≤‡ßá **window function** ‡¶π‡ßü‡ßá ‡¶Ø‡¶æ‡ßü‡•§

| Function  | ‡¶ï‡¶æ‡¶ú                              |
| --------- | -------------------------------- |
| `SUM()`   | ‡¶è‡¶ï‡¶ü‡¶ø ‡¶™‡¶æ‡¶∞‡ßç‡¶ü‡¶ø‡¶∂‡¶®/‡¶â‡¶á‡¶®‡ßç‡¶°‡ßã ‡¶ú‡ßÅ‡ßú‡ßá ‡¶Ø‡ßã‡¶ó‡¶´‡¶≤‡•§ |
| `AVG()`   | ‡¶ó‡ßú ‡¶¨‡ßá‡¶∞ ‡¶ï‡¶∞‡ßá‡•§                      |
| `MIN()`   | ‡¶∏‡¶∞‡ßç‡¶¨‡¶®‡¶ø‡¶Æ‡ßç‡¶® ‡¶Æ‡¶æ‡¶®‡•§                   |
| `MAX()`   | ‡¶∏‡¶∞‡ßç‡¶¨‡ßã‡¶ö‡ßç‡¶ö ‡¶Æ‡¶æ‡¶®‡•§                    |
| `COUNT()` | ‡¶ó‡¶£‡¶®‡¶æ ‡¶ï‡¶∞‡ßá‡•§                        |


### Dataset

```sql
CREATE TABLE Students (
    Student VARCHAR(10),
    Score INT
);

INSERT INTO Students (Student, Score) VALUES
('A', 95),
('B', 85),
('C', 85),
('D', 75),
('E', 70),
('F', 70),
('G', 60);
```

---

### Query (Aggregate Functions as Window Functions)

```sql
SELECT
    Student,
    Score,

    SUM(Score)   OVER () AS Total_Sum,        -- ‡¶∏‡¶¨ ‡¶∞‡ßã ‡¶è‡¶∞ ‡¶Ø‡ßã‡¶ó‡¶´‡¶≤
    AVG(Score)   OVER () AS Avg_Score,        -- ‡¶∏‡¶¨ ‡¶∞‡ßã ‡¶è‡¶∞ ‡¶ó‡ßú
    MIN(Score)   OVER () AS Min_Score,        -- ‡¶∏‡¶¨ ‡¶∞‡ßã ‡¶è‡¶∞ ‡¶∏‡¶∞‡ßç‡¶¨‡¶®‡¶ø‡¶Æ‡ßç‡¶®
    MAX(Score)   OVER () AS Max_Score,        -- ‡¶∏‡¶¨ ‡¶∞‡ßã ‡¶è‡¶∞ ‡¶∏‡¶∞‡ßç‡¶¨‡ßã‡¶ö‡ßç‡¶ö
    COUNT(Score) OVER () AS Total_Count       -- ‡¶∏‡¶¨ ‡¶∞‡ßã ‡¶è‡¶∞ ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ

FROM Students;
```

---

### Output (Window ‡¶õ‡¶æ‡ßú‡¶æ Group ‡¶ï‡¶∞‡¶≤‡ßá ‡¶è‡¶ï ‡¶≤‡¶æ‡¶á‡¶®‡ßá ‡¶Ü‡¶∏‡¶§‡ßã, ‡¶ï‡¶ø‡¶®‡ßç‡¶§‡ßÅ ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶ø ‡¶∞‡ßã-‡¶§‡ßá‡¶á ‡¶∞‡ßá‡¶ú‡¶æ‡¶≤‡ßç‡¶ü ‡¶¶‡ßá‡¶ñ‡¶æ‡¶¨‡ßá)

| Student | Score | Total\_Sum | Avg\_Score | Min\_Score | Max\_Score | Total\_Count |
| ------- | ----- | ---------- | ---------- | ---------- | ---------- | ------------ |
| A       | 95    | 540        | 77.14      | 60         | 95         | 7            |
| B       | 85    | 540        | 77.14      | 60         | 95         | 7            |
| C       | 85    | 540        | 77.14      | 60         | 95         | 7            |
| D       | 75    | 540        | 77.14      | 60         | 95         | 7            |
| E       | 70    | 540        | 77.14      | 60         | 95         | 7            |
| F       | 70    | 540        | 77.14      | 60         | 95         | 7            |
| G       | 60    | 540        | 77.14      | 60         | 95         | 7            |


---

## **3Ô∏è‚É£ Value Functions** (‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡¶¨‡¶∞‡ßç‡¶§‡ßÄ ‡¶¨‡¶æ ‡¶™‡¶∞‡¶¨‡¶∞‡ßç‡¶§‡ßÄ ‡¶∞‡ßã-‡¶è‡¶∞ ‡¶°‡ßá‡¶ü‡¶æ ‡¶Ü‡¶®‡¶æ)

| Function        | ‡¶ï‡¶æ‡¶ú                                           |
| --------------- | --------------------------------------------- |
| `LAG(expr, n)`  | ‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶∞‡ßã ‡¶•‡ßá‡¶ï‡ßá **n ‡¶∞‡ßã ‡¶Ü‡¶ó‡ßá** ‡¶•‡¶æ‡¶ï‡¶æ ‡¶≠‡ßç‡¶Ø‡¶æ‡¶≤‡ßÅ ‡¶Ü‡¶®‡ßá‡•§ |
| `LEAD(expr, n)` | ‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶∞‡ßã ‡¶•‡ßá‡¶ï‡ßá **n ‡¶∞‡ßã ‡¶™‡¶∞‡ßá** ‡¶•‡¶æ‡¶ï‡¶æ ‡¶≠‡ßç‡¶Ø‡¶æ‡¶≤‡ßÅ ‡¶Ü‡¶®‡ßá‡•§ |
| `FIRST_VALUE()` | ‡¶â‡¶á‡¶®‡ßç‡¶°‡ßã‡¶∞ ‡¶™‡ßç‡¶∞‡¶•‡¶Æ ‡¶≠‡ßç‡¶Ø‡¶æ‡¶≤‡ßÅ ‡¶Ü‡¶®‡ßá‡•§                     |
| `LAST_VALUE()`  | ‡¶â‡¶á‡¶®‡ßç‡¶°‡ßã‡¶∞ ‡¶∂‡ßá‡¶∑ ‡¶≠‡ßç‡¶Ø‡¶æ‡¶≤‡ßÅ ‡¶Ü‡¶®‡ßá‡•§                       |
| `NTH_VALUE()`   | ‡¶â‡¶á‡¶®‡ßç‡¶°‡ßã‡¶∞ n-‡¶§‡¶Æ ‡¶≠‡ßç‡¶Ø‡¶æ‡¶≤‡ßÅ ‡¶Ü‡¶®‡ßá‡•§                      |

### Example

### Dataset

```sql
CREATE TABLE Students (
    Student VARCHAR(10),
    Score INT
);

INSERT INTO Students (Student, Score) VALUES
('A', 95),
('B', 85),
('C', 85),
('D', 75),
('E', 70),
('F', 70),
('G', 60);
```

### Query (Value Functions)

```sql
SELECT
    Student,
    Score,

    LAG(Score, 1)  OVER (ORDER BY Score DESC) AS Prev_Score,   -- 1 ‡¶∞‡ßã ‡¶Ü‡¶ó‡ßá
    LEAD(Score, 1) OVER (ORDER BY Score DESC) AS Next_Score,   -- 1 ‡¶∞‡ßã ‡¶™‡¶∞‡ßá

    FIRST_VALUE(Score) OVER (ORDER BY Score DESC) AS First_Score, -- ‡¶™‡ßç‡¶∞‡¶•‡¶Æ ‡¶≠‡ßç‡¶Ø‡¶æ‡¶≤‡ßÅ
    LAST_VALUE(Score)  OVER (ORDER BY Score DESC 
                             ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS Last_Score, -- ‡¶∂‡ßá‡¶∑ ‡¶≠‡ßç‡¶Ø‡¶æ‡¶≤‡ßÅ

    NTH_VALUE(Score, 3) OVER (ORDER BY Score DESC 
                              ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS Third_Score -- ‡ß©‡ßü ‡¶≠‡ßç‡¶Ø‡¶æ‡¶≤‡ßÅ

FROM Students;
```

### Output

| Student | Score | Prev\_Score | Next\_Score | First\_Score | Last\_Score | Third\_Score |
| ------- | ----- | ----------- | ----------- | ------------ | ----------- | ------------ |
| A       | 95    | NULL        | 85          | 95           | 60          | 85           |
| B       | 85    | 95          | 85          | 95           | 60          | 85           |
| C       | 85    | 85          | 75          | 95           | 60          | 85           |
| D       | 75    | 85          | 70          | 95           | 60          | 85           |
| E       | 70    | 75          | 70          | 95           | 60          | 85           |
| F       | 70    | 70          | 60          | 95           | 60          | 85           |
| G       | 60    | 70          | NULL        | 95           | 60          | 85           |



---

## **4Ô∏è‚É£ Statistical / Offset Functions** (‡¶°‡¶ø‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡¶ø‡¶¨‡¶ø‡¶â‡¶∂‡¶® ‡¶¨‡¶æ ‡¶∂‡¶§‡¶æ‡¶Ç‡¶∂ ‡¶®‡¶ø‡¶∞‡ßç‡¶ß‡¶æ‡¶∞‡¶£ ‡¶ï‡¶∞‡ßá)

| Function            | ‡¶ï‡¶æ‡¶ú                                                                    |
| ------------------- | ---------------------------------------------------------------------- |
| `PERCENT_RANK()`    | 0‚Äì1 ‡¶∏‡ßç‡¶ï‡ßá‡¶≤‡ßá ‡¶∞‚Äå‡ßç‡¶Ø‡¶æ‡¶ô‡ßç‡¶ï ‡¶®‡¶ø‡¶∞‡ßç‡¶ß‡¶æ‡¶∞‡¶£ ‡¶ï‡¶∞‡ßá‡•§                                      |
| `CUME_DIST()`       | cumulative distribution ‚Äî ‡¶è‡¶ï‡¶ü‡¶ø ‡¶∞‡ßã-‡¶è‡¶∞ ‡¶Ü‡¶ó‡ßá ‡¶¨‡¶æ ‡¶∏‡¶Æ‡¶æ‡¶® ‡¶∏‡ßç‡¶ï‡ßã‡¶∞‡ßá‡¶∞ ‡¶∞‡ßã-‡¶è‡¶∞ ‡¶Ö‡¶®‡ßÅ‡¶™‡¶æ‡¶§‡•§ |
| `RATIO_TO_REPORT()` | ‡¶è‡¶ï‡¶ü‡¶ø ‡¶≠‡ßç‡¶Ø‡¶æ‡¶≤‡ßÅ‡¶∞ ‡¶Ö‡¶®‡ßÅ‡¶™‡¶æ‡¶§ ‡¶™‡ßÅ‡¶∞‡ßã ‡¶™‡¶æ‡¶∞‡ßç‡¶ü‡¶ø‡¶∂‡¶®‡ßá‡¶∞ ‡¶Ø‡ßã‡¶ó‡¶´‡¶≤‡ßá‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá‡•§                      |

---

üí° **‡¶Æ‡¶®‡ßá ‡¶∞‡¶æ‡¶ñ‡¶¨‡ßá**

* ‡¶∏‡¶¨ Window Function-‡¶è‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá `OVER()` ‡¶ï‡ßç‡¶≤‡¶ú ‡¶•‡¶æ‡¶ï‡ßá, ‡¶Ø‡ßá‡¶ü‡¶æ ‡¶¶‡¶ø‡ßü‡ßá `PARTITION BY` ‡¶ì `ORDER BY` ‡¶†‡¶ø‡¶ï ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡•§
* `PARTITION BY` = ‡¶°‡ßá‡¶ü‡¶æ ‡¶ó‡ßç‡¶∞‡ßÅ‡¶™ ‡¶ï‡¶∞‡¶æ
* `ORDER BY` (inside OVER) = ‡¶â‡¶á‡¶®‡ßç‡¶°‡ßã‡¶∞ ‡¶≠‡¶ø‡¶§‡¶∞‡ßá ‡¶∏‡¶æ‡¶ú‡¶æ‡¶®‡ßã

